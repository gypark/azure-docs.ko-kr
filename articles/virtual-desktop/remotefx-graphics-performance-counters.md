---
title: 원격 데스크톱-Azure의에서 그래픽 성능 문제 진단
description: 이 문서에서는 원격 데스크톱 프로토콜 세션에서 RemoteFX 그래픽 카운터를 사용 하 여 Windows 가상 데스크톱의 그래픽을 사용 하 여 성능 문제를 진단 하는 방법을 설명 합니다.
services: virtual-desktop
author: ChJenk
ms.service: virtual-desktop
ms.topic: troubleshoot
ms.date: 05/23/2019
ms.author: v-chjenk
ms.openlocfilehash: 0b4113f1e0024415135aa99d1fb4e881efe448a3
ms.sourcegitcommit: 600d5b140dae979f029c43c033757652cddc2029
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 06/04/2019
ms.locfileid: "66499266"
---
# <a name="diagnose-graphics-performance-issues-in-remote-desktop"></a>원격 데스크톱의 그래픽 성능 문제 진단

시스템은 예상 대로 작동 하지 않습니다 때 문제의 원인을 식별 하는 것이 중요 합니다. 이 문서에서는 식별 하 고 원격 데스크톱 프로토콜 (RDP) 세션 중 그래픽 관련 성능 병목 상태를 해결 합니다.

## <a name="find-your-remote-session-name"></a>원격 세션 이름 찾기

원격 세션 이름을 그래픽 성능 카운터를 식별 해야 합니다. 에 Windows 가상 데스크톱 미리 보기 원격 세션 이름을 식별 하기 위해이 섹션의 지침을 따릅니다.

1. 원격 세션에서 Windows 명령 프롬프트를 엽니다.
2. 실행 합니다 **qwinsta** 명령입니다.
    - 세션 다중 세션 가상 컴퓨터 (VM)에서 호스팅되는 경우: 각 카운터 이름에 대 한 접미사를 세션 이름에 "rdp-tcp 37."와 같은 동일한 접미사는
    - 세션 가상 그래픽 처리 장치 (vGPU)를 지 원하는 VM에서 호스팅되는 경우: 카운터는 VM 대신 서버에 저장 됩니다. 카운터 인스턴스가 세션 이름에 같은 번호 대신 VM 이름의 포함할 "Win8 Enterprise VM입니다."

>[!NOTE]
> 카운터 이름에 RemoteFX가 하는 동안 원격 데스크톱 그래픽 vGPU 시나리오에 포함 됩니다.

## <a name="access-performance-counters"></a>성능 카운터에 액세스

RemoteFX 그래픽에서 성능 카운터 프레임 시간 인코딩 등을 추적할 수 있도록 하 여 병목 상태를 검색 하는 데 도움이 및 프레임을 건너뜁니다.

원격 세션 이름을, 결정 한 후 원격 세션에 대 한 RemoteFX 그래픽 성능 카운터를 수집 하려면 다음이 지침을 따릅니다.

1. 선택 **시작** > **관리 도구** > **성능 모니터**합니다.
2. 에 **성능 모니터** 대화 상자에서 **모니터링 도구**를 선택 **성능 모니터**를 선택한 후 **추가**합니다.
3. 에 **카운터 추가** 대화 상자에서를 **사용 가능한 카운터** 목록에서 RemoteFX 그래픽에 대 한 성능 카운터 개체를 확장 합니다.
4. 모니터링할 카운터를 선택 합니다.
5. 에 **선택한 개체의 인스턴스** 목록에서 선택한 카운터에 대 한 모니터링 및 선택한 특정 인스턴스 **추가**합니다. 모든 사용 가능한 카운터 인스턴스를 선택 하려면 **모든 인스턴스**합니다.
6. 카운터를 추가한 후 선택할 **확인**합니다.

선택한 성능 카운터는 성능 모니터 화면에 표시 됩니다.

>[!NOTE]
>호스트에서 각 활성 세션에는 고유한 인스턴스의 각 성능 카운터

## <a name="diagnosis"></a>진단

그래픽 관련 성능 문제는 일반적으로 4 개의 범주로 구분 됩니다.

- 낮은 프레임 속도
- 임의 대기
- 입력된 대기
- 잘못 된 프레임 품질

낮은 프레임 속도, 임의 정지 되 고 및 입력된 대기 시간이 긴 주소를 지정 하 여 시작 합니다. 다음 섹션에서는 각 범주를 측정 하는 성능 카운터 알려줍니다를 보여 줍니다.

### <a name="performance-counters"></a>성능 카운터

이 섹션에는 병목 상태를 확인할 수 있습니다.

먼저 출력 Frames/Second 카운터를 확인 합니다. 클라이언트에 게 제공 하는 프레임 수가 측정 합니다. 이 값을 사용 하면 입력 Frames/Second 카운터 보다 작으면, 프레임을 건너뛰어 되 고 있습니다. 병목 상태를 식별 하려면 프레임 건너뜀 초당 카운터를 사용 합니다.

프레임 건너뜀 초당 카운터는 다음과 같은 세 종류가 있습니다.

- 건너뛴 초당 프레임 (부족 하 여 네트워크 리소스)
- 건너뛴 초당 프레임 (부족 하 여 클라이언트 리소스)
- 건너뛴 초당 프레임 (서버 리소스 부족)

건너뜀 초당 카운터 문제가 리소스와 관련이 있는 것을 의미 하는 프레임에 대 한 값이 크면 카운터를 추적 합니다. 예를 들어, 클라이언트 디코드 하지 않습니다 동일한 비율 서버에 있는 프레임 프레임을 제공 하는 경우 프레임 건너뜀 초당 (클라이언트 리소스 부족) 카운터가 많아집니다.

출력 Frames/Second 카운터 입력 Frames/Second 카운터 일치 하는 경우 아직 아직 비정상적인 지연 또는 지연 문제가 있을 수 평균 인코딩 시간. 단일 세션 (vGPU) 시나리오에서 서버 및 다중 세션 시나리오에서 VM에서 발생 하는 동기 프로세스 인코딩은입니다. 인코딩 평균 시간 33 밀리초 미만 이어야 합니다. 평균 인코딩 시간은 아래 33 ms 하지만 성능 문제가 있는 경우 응용 프로그램 또는 운영 체제를 사용 하는 문제가 있을 수 있습니다.

앱 관련 문제를 진단 하는 방법에 대 한 자세한 내용은 참조 하세요. [사용자 입력 지연 성능 카운터](https://docs.microsoft.com/windows-server/remote/remote-desktop-services/rds-rdsh-performance-counters)합니다.

RDP는 3만 3천 ms의 평균 인코딩 시간을 지원 하므로 30 최대 입력된 프레임 속도 초당 프레임 지원 합니다. 참고는 3만 3천 ms 지원 되는 최대 프레임 속도입니다. 대부분의 경우 사용자가 숙련 된 프레임 속도 프레임 원본에서 RDP에 제공 되는 빈도 따라 낮은 됩니다. 예를 들어 작업 같은 감시 비디오 필요 30 전체 입력된 프레임 속도 프레임/초 하지만 자주 word 문서를 편집 하는 등의 작은 리소스 집약적 작업 좋은 사용자 환경을 위해 이러한 높은 비율의 초당 프레임 수 입력된 필요 하지 않습니다.

프레임 품질 문제를 진단 하는 프레임 품질 카운터를 사용 합니다. 이 카운터는 원본 프레임의 품질에 대 한 백분율로 출력 프레임의 품질을 표현합니다. 품질 손실 RemoteFX를 때문일 수 있습니다 또는 그래픽 원본에 내재 된 것입니다. RemoteFX 품질 손실 발생할 경우 충실도 높은 콘텐츠를 보낼 네트워크 또는 서버 리소스 부족 문제 수도 있습니다.

## <a name="mitigation"></a>해결 방법

서버 리소스 병목 상태를 유발 하는 경우 성능 향상을 위해 다음 중 하나를 시도 합니다.

- 호스트당 세션의 수를 줄입니다.
- 메모리를 늘리고 서버에서 리소스를 계산 합니다.
- 연결의 해상도 삭제 합니다.

네트워크 리소스 병목 상태를 유발 하는 경우 세션당 네트워크 가용성을 개선 하기 위해 다음 중 하나를 시도 합니다.

- 호스트당 세션의 수를 줄입니다.
- 연결의 해상도 삭제 합니다.
- 더 높은 대역폭 네트워크를 사용 합니다.

클라이언트 리소스 병목 상태를 유발 하는 경우 성능 향상을 위해 다음 작업 중 하나 또는 모두를 수행 합니다.

- 가장 최근의 원격 데스크톱 클라이언트를 설치 합니다.
- 메모리를 늘리고 클라이언트 컴퓨터의 리소스를 계산 합니다.

> [!NOTE]
> 원본 Frames/Second 카운터 현재 지원 하지 않습니다. 이제 원본 Frames/Second 카운터가 0으로 설정 항상 됩니다.

## <a name="next-steps"></a>다음 단계

- GPU 액세스에 최적화 된 Azure 가상 컴퓨터를 참조 하세요 [그래픽 처리 유닛 (GPU) 가속 Windows 가상 데스크톱 미리 보기 환경에 대 한 구성](https://docs.microsoft.com/azure/virtual-desktop/configure-vm-gpu)합니다.
- 문제 해결 및 에스컬레이션 트랙의 개요를 보려면 [문제 해결 개요, 피드백 및 지원](https://docs.microsoft.com/azure/virtual-desktop/troubleshoot-set-up-overview)합니다.
- 미리 보기 서비스에 대 한 자세한 내용은 참조 하세요 [Windows 데스크톱 미리 보기 환경](https://docs.microsoft.com/azure/virtual-desktop/environment-setup)합니다.
